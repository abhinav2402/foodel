angular.module("app",["ngRoute","ui.router"]),angular.module("app").controller("errorCtrl",["$scope","$rootScope",function(e,o){e.hello="this is from the controller hello",console.log(e.hello)}]),angular.module("app").controller("homeCtrl",["$scope","$http",function(e,o){e.model={},e.markonGoogleMap=function(){"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(function(o){console.log(o.coords.latitude,o.coords.longitude);var t=o.coords.latitude,n=o.coords.longitude,l=new google.maps.Geocoder,r=new google.maps.LatLng(t,n);l.geocode({latLng:r},function(o,t){if(t==google.maps.GeocoderStatus.OK){if(o[0])for(var n=o[0].address_components,l=0;l<n.length;l++){if("sublocality_level_3"==n[l].types[0])var r=n[l].long_name;if("sublocality_level_2"==n[l].types[0])var a=n[l].long_name;if("sublocality_level_1"==n[l].types[0])var s=n[l].long_name;if("locality"==n[l].types[0])var c=n[l].long_name;if("administrative_area_level_1"==n[l].types[0])var i=n[l].long_name;if("country"==n[l].types[0]){var u=n[l].long_name;console.log(u)}if("postal_code"==n[l].types[0]){var g=n[l].long_name;console.log(g)}}e.model.area=r+", "+a+", "+s+", "+c+", "+i+", "+u,e.$digest(),console.log(e.model.area),console.log(n)}})});var o=document.getElementById("place"),t=new google.maps.places.Autocomplete(o);google.maps.event.addListener(t,"place_changed",function(){var e=t.getPlace();return e.geometry?void console.log(e):void window.alert("Autocomplete's returned place contains no geometry")})},e.markonGoogleMap()}]),angular.module("app").controller("loginCtrl",["$scope","auth","$location","$timeout",function(e,o,t,n){e.authFail=!1,e.login=function(t,l){o.login(t,l).then(function(e){o.storeToken(e.data,function(){o.getUser().then(function(e){o.postLoginOps(e.data,function(){o.postLoginRouteHandler()})})})})["catch"](function(o){console.error("Gists error",o.status,o.data),401==o.status&&(e.authFail=!0,n(function(){e.authFail=!1},3e3))})["finally"](function(){console.log("finally finished gists")})}}]),angular.module("app").controller("masterCtrl",["$scope","$rootScope","$route",function(e,o,t){console.log("masterCtrl"),localStorage.getItem("logged_user")&&(o.currentUser=localStorage.getItem("logged_user")),e.$on("login",function(t,n){console.log("Logged In"),e.currentUser=n,o.currentUser=n,localStorage.setItem("logged_user",o.currentUser.username)})}]),angular.module("app").controller("navCtrl",["$scope","auth","$location",function(e,o,t){e.logout=function(){o.logout()}}]),angular.module("app").controller("PostsCtrl",["$scope","PostsSvc",function(e,o){o.fetch().success(function(o){e.posts=o}),e.addPost=function(){e.postBody&&o.create({body:e.postBody}).success(function(o){e.postBody=null})},e.$on("ws:new_post",function(o,t){e.$apply(function(){e.posts.unshift(t)})})}]),angular.module("app").service("PostsSvc",["$http",function(e){this.fetch=function(){return e.get("/api/posts")},this.create=function(o){return e.post("/api/posts",o)}}]),angular.module("app").controller("registerCtrl",["$scope","auth","$location",function(e,o,t){e.register=function(n,l,r){o.register(n,l,r).then(function(o){e.$emit("login",o.data),t.path("/home")})["catch"](function(e){console.log(e)})}}]),angular.module("app").config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,o,t){o.otherwise("/"),e.state("app",{url:"/",views:{header:{templateUrl:"/nav.html",controller:"navCtrl"},content:{templateUrl:"users/home.html",controller:"homeCtrl"}}}).state("app.login",{url:"login",views:{header:{templateUrl:"/nav.html",controller:"navCtrl"},content:{templateUrl:"/login.html",controller:"loginCtrl"}}}).state("app.register",{url:"register",views:{"content@":{templateUrl:"register.html",controller:"registerCtrl"}}}).state("app.home",{url:"home",views:{"content@":{templateUrl:"users/home.html",controller:"homeCtrl"}}}).state("app.home.vehicles",{url:"/vehicles/new",views:{"content@":{templateUrl:"vehicles/newVehicle.html",controller:"VehiclesNewInfoCtrl"}}}).state("app.home.details",{url:"/vehicles/:id",views:{"content@":{templateUrl:"vehicles/editVehicle.html",controller:"VehiclesEditInfoCtrl"}}}).state("app.home.map",{url:"/vehicles/map/:id",views:{"content@":{templateUrl:"vehicles/mapVehicle.html",controller:"VehiclesEditMapCtrl"}}}),t.html5Mode(!0)}]),angular.module("app").service("auth",["$http","$window","$location","$rootScope",function(e,o,t,n){function l(){return e.get("api/users")}function r(o,t){return e.post("api/sessions",{username:o,password:t})}function a(){localStorage.removeItem("user_token"),localStorage.removeItem("logged_user"),delete e.defaults.headers.common["x-auth"],n.isLogged=!1,n.currentUser=null,t.path("/login")}function s(t,n){o.sessionStorage.user_token=t,localStorage.setItem("user_token",t),e.defaults.headers.common["x-auth"]=o.sessionStorage.user_token,n&&"function"==typeof n&&n()}function c(){}function i(e,o){n.currentUser=e.name,localStorage.setItem("logged_user",n.currentUser),n.isLogged=!0,o&&"function"==typeof o&&o()}function u(){n.intendedRoute?t.path(n.intendedRoute):t.path("/home")}return{getUser:l,login:r,logout:a,storeToken:s,isLogged:c,postLoginOps:i,postLoginRouteHandler:u}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImNvbnRyb2xsZXJzL2Vycm9yQ3RybC5qcyIsImNvbnRyb2xsZXJzL2hvbWVDdHJsLmpzIiwiY29udHJvbGxlcnMvbG9naW5DdHJsLmpzIiwiY29udHJvbGxlcnMvbWFzdGVyQ3RybC5qcyIsImNvbnRyb2xsZXJzL25hdkN0cmwuanMiLCJjb250cm9sbGVycy9wb3N0cy5jdHJsLmpzIiwiY29udHJvbGxlcnMvcG9zdHMuc3ZjLmpzIiwiY29udHJvbGxlcnMvcmVnaXN0ZXJDdHJsLmpzIiwiY29udHJvbGxlcnMvcm91dGVzLmpzIiwic2VydmljZXMvYXV0aC5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29udHJvbGxlciIsIiRzY29wZSIsIiRyb290U2NvcGUiLCJoZWxsbyIsImNvbnNvbGUiLCJsb2ciLCIkaHR0cCIsIm1vZGVsIiwibWFya29uR29vZ2xlTWFwIiwibmF2aWdhdG9yIiwiZ2VvbG9jYXRpb24iLCJnZXRDdXJyZW50UG9zaXRpb24iLCJwb3NpdGlvbiIsImNvb3JkcyIsImxhdGl0dWRlIiwibG9uZ2l0dWRlIiwiZ2VvY29kZXIiLCJnb29nbGUiLCJtYXBzIiwiR2VvY29kZXIiLCJsYXRsbmciLCJMYXRMbmciLCJnZW9jb2RlIiwibGF0TG5nIiwicmVzdWx0cyIsInN0YXR1cyIsIkdlb2NvZGVyU3RhdHVzIiwiT0siLCJjb21wb25lbnRzIiwiYWRkcmVzc19jb21wb25lbnRzIiwiY29tcG9uZW50IiwidHlwZXMiLCJzdWJfbG9jYWxpdHkzIiwibG9uZ19uYW1lIiwic3ViX2xvY2FsaXR5MiIsInN1Yl9sb2NhbGl0eTEiLCJsb2NhbGl0eSIsImFkbWluX2FyZWEiLCJjb3VudHJ5IiwicG9zdGFsX2NvZGUiLCJhcmVhIiwiJGRpZ2VzdCIsImlucHV0IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImF1dG9jb21wbGV0ZSIsInBsYWNlcyIsIkF1dG9jb21wbGV0ZSIsImV2ZW50IiwiYWRkTGlzdGVuZXIiLCJwbGFjZSIsImdldFBsYWNlIiwiZ2VvbWV0cnkiLCJ3aW5kb3ciLCJhbGVydCIsImF1dGgiLCIkbG9jYXRpb24iLCIkdGltZW91dCIsImF1dGhGYWlsIiwibG9naW4iLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwidGhlbiIsInJlcyIsInN0b3JlVG9rZW4iLCJkYXRhIiwiZ2V0VXNlciIsInBvc3RMb2dpbk9wcyIsInBvc3RMb2dpblJvdXRlSGFuZGxlciIsInJlc3BvbnNlIiwiZXJyb3IiLCIkcm91dGUiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwiY3VycmVudFVzZXIiLCIkb24iLCJfIiwidXNlciIsInNldEl0ZW0iLCJsb2dvdXQiLCJQb3N0c1N2YyIsImZldGNoIiwic3VjY2VzcyIsInBvc3RzIiwiYWRkUG9zdCIsInBvc3RCb2R5IiwiY3JlYXRlIiwiYm9keSIsInBvc3QiLCIkYXBwbHkiLCJ1bnNoaWZ0Iiwic2VydmljZSIsInRoaXMiLCJnZXQiLCJyZWdpc3RlciIsIm5hbWUiLCIkZW1pdCIsInBhdGgiLCJlcnIiLCJjb25maWciLCIkc3RhdGVQcm92aWRlciIsIiR1cmxSb3V0ZXJQcm92aWRlciIsIiRsb2NhdGlvblByb3ZpZGVyIiwib3RoZXJ3aXNlIiwic3RhdGUiLCJ1cmwiLCJ2aWV3cyIsImhlYWRlciIsInRlbXBsYXRlVXJsIiwiY29udGVudCIsImNvbnRlbnRAIiwiaHRtbDVNb2RlIiwiJHdpbmRvdyIsInJlbW92ZUl0ZW0iLCJkZWZhdWx0cyIsImhlYWRlcnMiLCJjb21tb24iLCJpc0xvZ2dlZCIsImNiIiwic2Vzc2lvblN0b3JhZ2UiLCJ1c2VyX3Rva2VuIiwiaW50ZW5kZWRSb3V0ZSJdLCJtYXBwaW5ncyI6IkFBQUFBLFFBQUFDLE9BQUEsT0FDQSxVQUFBLGNDREFELFFBQUFDLE9BQUEsT0FDQUMsV0FBQSxhQUFBLFNBQUEsYUFBQSxTQUFBQyxFQUFBQyxHQUNBRCxFQUFBRSxNQUFBLG9DQUNBQyxRQUFBQyxJQUFBSixFQUFBRSxVQ0hBTCxRQUFBQyxPQUFBLE9BQ0FDLFdB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QTNHLEdBQUE0RyxTQUFBQyxRQUFBQyxPQUFBLFVBQ0FsSCxFQUFBbUgsVUFBQSxFQUNBbkgsRUFBQXdFLFlBQUEsS0FDQWxCLEVBQUF5QyxLQUFBLFVBTUEsUUFBQWpDLEdBQUFELEVBQUF1RCxHQUNBTixFQUFBTyxlQUFBLFdBQUF4RCxFQUNBUyxhQUFBTSxRQUFBLGFBQUFmLEdBQ0F6RCxFQUFBNEcsU0FBQUMsUUFBQUMsT0FBQSxVQUFBSixFQUFBTyxlQUFBQyxXQUNBRixHQUFBLGtCQUFBQSxJQUNBQSxJQUlBLFFBQUFELE1BSUEsUUFBQWxELEdBQUFKLEVBQUF1RCxHQUdBcEgsRUFBQXdFLFlBQUFYLEVBQUFnQyxLQUNBdkIsYUFBQU0sUUFBQSxjQUFBNUUsRUFBQXdFLGFBQ0F4RSxFQUFBbUgsVUFBQSxFQUNBQyxHQUFBLGtCQUFBQSxJQUNBQSxJQUtBLFFBQUFsRCxLQUNBbEUsRUFBQXVILGNBQ0FqRSxFQUFBeUMsS0FBQS9GLEVBQUF1SCxlQUVBakUsRUFBQXlDLEtBQUEsU0FqRUEsT0FDQS9CLFFBQUFBLEVBQ0FQLE1BQUFBLEVBQ0FvQixPQUFBQSxFQUNBZixXQUFBQSxFQUNBcUQsU0FBQUEsRUFDQWxELGFBQUFBLEVBQ0FDLHNCQUFBQSIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYXBwJyxbXG4nbmdSb3V0ZScsJ3VpLnJvdXRlcidcbl0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4gICAgLmNvbnRyb2xsZXIoJ2Vycm9yQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJHJvb3RTY29wZSkge1xuICAgICAgICAkc2NvcGUuaGVsbG8gPSBcInRoaXMgaXMgZnJvbSB0aGUgY29udHJvbGxlciBoZWxsb1wiXG4gICAgICAgIGNvbnNvbGUubG9nKCRzY29wZS5oZWxsbylcblxuXG5cbiAgICB9KVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4gICAgLmNvbnRyb2xsZXIoJ2hvbWVDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCkge1xuICAgICAgICAkc2NvcGUubW9kZWwgPSB7fVxuXG4gICAgICAgICRzY29wZS5tYXJrb25Hb29nbGVNYXAgPSBmdW5jdGlvbiBpbml0aWFsaXplKCkge1xuICAgICAgICAgICAgaWYgKFwiZ2VvbG9jYXRpb25cIiBpbiBuYXZpZ2F0b3IpIHtcbiAgICAgICAgICAgICAgICBuYXZpZ2F0b3IuZ2VvbG9jYXRpb24uZ2V0Q3VycmVudFBvc2l0aW9uKGZ1bmN0aW9uKHBvc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHBvc2l0aW9uLmNvb3Jkcy5sYXRpdHVkZSwgcG9zaXRpb24uY29vcmRzLmxvbmdpdHVkZSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsYXRpdHVkZSA9IHBvc2l0aW9uLmNvb3Jkcy5sYXRpdHVkZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxvbmdpdHVkZSA9IHBvc2l0aW9uLmNvb3Jkcy5sb25naXR1ZGU7XG4gICAgICAgICAgICAgICAgICAgIHZhciBnZW9jb2RlciA9IG5ldyBnb29nbGUubWFwcy5HZW9jb2RlcigpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFJldmVyc2UgR2VvY29kaW5nLCBMb2NhdGlvbiBuYW1lIGZyb20gY28tb3JkaW5hdGVzLlxuICAgICAgICAgICAgICAgICAgICB2YXIgbGF0bG5nID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhsYXRpdHVkZSwgbG9uZ2l0dWRlKTtcbiAgICAgICAgICAgICAgICAgICAgZ2VvY29kZXIuZ2VvY29kZSh7ICdsYXRMbmcnOiBsYXRsbmcgfSwgZnVuY3Rpb24ocmVzdWx0cywgc3RhdHVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdHVzID09IGdvb2dsZS5tYXBzLkdlb2NvZGVyU3RhdHVzLk9LKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdHNbMF0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbXBvbmVudHMgPSByZXN1bHRzWzBdLmFkZHJlc3NfY29tcG9uZW50cztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgY29tcG9uZW50ID0gMDsgY29tcG9uZW50IDwgKGNvbXBvbmVudHMubGVuZ3RoKTsgY29tcG9uZW50KyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb21wb25lbnRzW2NvbXBvbmVudF0udHlwZXNbMF0gPT0gXCJzdWJsb2NhbGl0eV9sZXZlbF8zXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViX2xvY2FsaXR5MyA9IGNvbXBvbmVudHNbY29tcG9uZW50XS5sb25nX25hbWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb21wb25lbnRzW2NvbXBvbmVudF0udHlwZXNbMF0gPT0gXCJzdWJsb2NhbGl0eV9sZXZlbF8yXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViX2xvY2FsaXR5MiA9IGNvbXBvbmVudHNbY29tcG9uZW50XS5sb25nX25hbWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb21wb25lbnRzW2NvbXBvbmVudF0udHlwZXNbMF0gPT0gXCJzdWJsb2NhbGl0eV9sZXZlbF8xXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViX2xvY2FsaXR5MSA9IGNvbXBvbmVudHNbY29tcG9uZW50XS5sb25nX25hbWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb21wb25lbnRzW2NvbXBvbmVudF0udHlwZXNbMF0gPT0gXCJsb2NhbGl0eVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxvY2FsaXR5ID0gY29tcG9uZW50c1tjb21wb25lbnRdLmxvbmdfbmFtZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbXBvbmVudHNbY29tcG9uZW50XS50eXBlc1swXSA9PSBcImFkbWluaXN0cmF0aXZlX2FyZWFfbGV2ZWxfMVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFkbWluX2FyZWEgPSBjb21wb25lbnRzW2NvbXBvbmVudF0ubG9uZ19uYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbXBvbmVudHNbY29tcG9uZW50XS50eXBlc1swXSA9PSBcImNvdW50cnlcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb3VudHJ5ID0gY29tcG9uZW50c1tjb21wb25lbnRdLmxvbmdfbmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhjb3VudHJ5KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29tcG9uZW50c1tjb21wb25lbnRdLnR5cGVzWzBdID09IFwicG9zdGFsX2NvZGVcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwb3N0YWxfY29kZSA9IGNvbXBvbmVudHNbY29tcG9uZW50XS5sb25nX25hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocG9zdGFsX2NvZGUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1vZGVsLmFyZWEgPSBzdWJfbG9jYWxpdHkzICsgJywgJyArIHN1Yl9sb2NhbGl0eTIgKyAnLCAnICsgc3ViX2xvY2FsaXR5MSArICcsICcgKyBsb2NhbGl0eSArICcsICcgKyBhZG1pbl9hcmVhICsgJywgJyArIGNvdW50cnlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuJGRpZ2VzdCgpOyAvLyBmaW5kIGEgYmV0dGVyIHdheSB0byBkbyB0aGlzLCBtYXkgYmUgY2FsbGJhY2tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUubW9kZWwuYXJlYSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhjb21wb25lbnRzKVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvKiBnZW9sb2NhdGlvbiBJUyBOT1QgYXZhaWxhYmxlICovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgaW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGxhY2UnKTtcbiAgICAgICAgICAgIHZhciBhdXRvY29tcGxldGUgPSBuZXcgZ29vZ2xlLm1hcHMucGxhY2VzLkF1dG9jb21wbGV0ZShpbnB1dCk7XG4gICAgICAgICAgICAvL2F1dG9jb21wbGV0ZS5iaW5kVG8oJ2JvdW5kcycsIG1hcCk7IGlmIGJvdW5kIG5lZWRzIHRvIGJlIHNldCB0byBiaWFzIHNlYXJjaFxuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIoYXV0b2NvbXBsZXRlLCAncGxhY2VfY2hhbmdlZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHZhciBwbGFjZSA9IGF1dG9jb21wbGV0ZS5nZXRQbGFjZSgpO1xuICAgICAgICAgICAgICAgIGlmICghcGxhY2UuZ2VvbWV0cnkpIHtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmFsZXJ0KFwiQXV0b2NvbXBsZXRlJ3MgcmV0dXJuZWQgcGxhY2UgY29udGFpbnMgbm8gZ2VvbWV0cnlcIik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHBsYWNlKTtcblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH1cblxuICAgICAgICAkc2NvcGUubWFya29uR29vZ2xlTWFwKCk7XG5cblxuXG5cblxuICAgIH0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbiAgICAuY29udHJvbGxlcignbG9naW5DdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBhdXRoLCAkbG9jYXRpb24sICR0aW1lb3V0KSB7XG4gICAgICAgICRzY29wZS5hdXRoRmFpbCA9IGZhbHNlO1xuICAgICAgICAkc2NvcGUubG9naW4gPSBmdW5jdGlvbih1c2VybmFtZSwgcGFzc3dvcmQpIHtcbiAgICAgICAgICAgIGF1dGgubG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICBhdXRoLnN0b3JlVG9rZW4ocmVzLmRhdGEsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXV0aC5nZXRVc2VyKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0aC5wb3N0TG9naW5PcHMocmVzLmRhdGEsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0aC5wb3N0TG9naW5Sb3V0ZUhhbmRsZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdHaXN0cyBlcnJvcicsIHJlc3BvbnNlLnN0YXR1cywgcmVzcG9uc2UuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT0gNDAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYXV0aEZhaWwgPSB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHsgJHNjb3BlLmF1dGhGYWlsID0gZmFsc2U7IH0sIDMwMDApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuZmluYWxseShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJmaW5hbGx5IGZpbmlzaGVkIGdpc3RzXCIpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgfVxuICAgIH0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbiAgICAuY29udHJvbGxlcignbWFzdGVyQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJHJvb3RTY29wZSwgJHJvdXRlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwibWFzdGVyQ3RybFwiKTtcblxuICAgICAgICBpZiAobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2xvZ2dlZF91c2VyJykpIHsgICAgICAgIFx0XG4gICAgICAgICAgICAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2xvZ2dlZF91c2VyJylcbiAgICAgICAgfVxuICAgICAgICAkc2NvcGUuJG9uKCdsb2dpbicsIGZ1bmN0aW9uKF8sIHVzZXIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTG9nZ2VkIEluXCIpO1xuICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnRVc2VyID0gdXNlclxuICAgICAgICAgICAgJHJvb3RTY29wZS5jdXJyZW50VXNlciA9IHVzZXJcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdsb2dnZWRfdXNlcicsICRyb290U2NvcGUuY3VycmVudFVzZXIudXNlcm5hbWUpXG4gICAgICAgIH0pXG4gICAgfSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuICAgIC5jb250cm9sbGVyKCduYXZDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBhdXRoLCAkbG9jYXRpb24pIHsgICAgICAgIFxuICAgICAgICAkc2NvcGUubG9nb3V0ID0gZnVuY3Rpb24oKSB7ICAgICAgICAgICAgXG4gICAgICAgICAgICBhdXRoLmxvZ291dCgpICAgICAgICAgICAgICAgIFxuXG4gICAgICAgIH1cbiAgICB9KVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignUG9zdHNDdHJsJyxmdW5jdGlvbigkc2NvcGUsUG9zdHNTdmMpeyBcbiAgUG9zdHNTdmMuZmV0Y2goKVxuIFx0LnN1Y2Nlc3MoZnVuY3Rpb24gKHBvc3RzKXtcbiBcdFx0JHNjb3BlLnBvc3RzID0gcG9zdHNcblxuIFx0fSlcblx0XG4gXHQgJHNjb3BlLmFkZFBvc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgaWYgKCRzY29wZS5wb3N0Qm9keSkge1xuICAgICAgICAgICAgUG9zdHNTdmMuY3JlYXRlKHtcbiAgICAgICAgICAgICAgLyp1c2VybmFtZTogJ3Zpc2hhbFJhbmphbicsKi9cbiAgICAgICAgICAgICAgYm9keTogICAgICRzY29wZS5wb3N0Qm9keSAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9KS5zdWNjZXNzKGZ1bmN0aW9uIChwb3N0KSB7XG4gICAgICAgICAgICAgIC8vJHNjb3BlLnBvc3RzLnVuc2hpZnQocG9zdClcbiAgICAgICAgICAgICAgJHNjb3BlLnBvc3RCb2R5ID0gbnVsbFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICRzY29wZS4kb24oJ3dzOm5ld19wb3N0JyxmdW5jdGlvbihfLHBvc3Qpe1xuICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKXtcbiAgICAgICRzY29wZS5wb3N0cy51bnNoaWZ0KHBvc3QpXG4gICAgfSlcbiAgfSlcbiBcbn0pXG5cbiAiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5zZXJ2aWNlKCdQb3N0c1N2YycsIGZ1bmN0aW9uKCRodHRwKXtcbiAgIHRoaXMuZmV0Y2ggPSBmdW5jdGlvbiAoKSB7ICAgXHRcbiAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9wb3N0cycpXG4gICB9XG4gICB0aGlzLmNyZWF0ZSA9IGZ1bmN0aW9uIChwb3N0KXtcbiAgIFx0XG4gICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9wb3N0cycscG9zdClcbiAgIH1cbiB9KSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ3JlZ2lzdGVyQ3RybCcsZnVuY3Rpb24oJHNjb3BlLGF1dGggLCRsb2NhdGlvbil7XG5cdCRzY29wZS5yZWdpc3RlciA9IGZ1bmN0aW9uKG5hbWUsdXNlcm5hbWUscGFzc3dvcmQpe1xuXHRcdGF1dGgucmVnaXN0ZXIobmFtZSx1c2VybmFtZSxwYXNzd29yZClcblx0XHQudGhlbihmdW5jdGlvbihyZXNwb25zZSl7XHRcdFx0XG5cdFx0XHQkc2NvcGUuJGVtaXQoJ2xvZ2luJyxyZXNwb25zZS5kYXRhKVxuXHRcdFx0JGxvY2F0aW9uLnBhdGgoJy9ob21lJylcblx0XHR9KVxuXHRcdC5jYXRjaChmdW5jdGlvbiAoZXJyKXtcblx0XHRcdGNvbnNvbGUubG9nKGVycilcblx0XHR9KVxuXHR9XG5cbn0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb25maWcoZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlciwkbG9jYXRpb25Qcm92aWRlcil7XG4gXG4gICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpO1xuIFxuICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgLnN0YXRlKCdhcHAnLHtcbiAgICAgICAgdXJsOiAnLycsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgICAnaGVhZGVyJzoge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL25hdi5odG1sJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnbmF2Q3RybCdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAnY29udGVudCc6IHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3VzZXJzL2hvbWUuaHRtbCcgLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdob21lQ3RybCdcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pXG5cbiAgICAuc3RhdGUoJ2FwcC5sb2dpbicse1xuICAgICAgICB1cmw6ICdsb2dpbicsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgICAnaGVhZGVyJzoge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL25hdi5odG1sJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnbmF2Q3RybCdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAnY29udGVudCc6IHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9sb2dpbi5odG1sJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnbG9naW5DdHJsJ1xuXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KVxuIFxuICAgIC5zdGF0ZSgnYXBwLnJlZ2lzdGVyJywge1xuICAgICAgICB1cmw6ICdyZWdpc3RlcicsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgICAnY29udGVudEAnOiB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdyZWdpc3Rlci5odG1sJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAncmVnaXN0ZXJDdHJsJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gXG4gICAgfSlcbiBcbiAgICAuc3RhdGUoJ2FwcC5ob21lJywge1xuICAgICAgICB1cmw6ICdob21lJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAgICdjb250ZW50QCc6IHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3VzZXJzL2hvbWUuaHRtbCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ2hvbWVDdHJsJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gXG4gICAgfSlcblxuICAgICAuc3RhdGUoJ2FwcC5ob21lLnZlaGljbGVzJywge1xuICAgICAgICB1cmw6ICcvdmVoaWNsZXMvbmV3JyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAgICdjb250ZW50QCc6IHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZlaGljbGVzL25ld1ZlaGljbGUuaHRtbCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1ZlaGljbGVzTmV3SW5mb0N0cmwnXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiBcbiAgICB9KVxuXG4gICAgIC5zdGF0ZSgnYXBwLmhvbWUuZGV0YWlscycsIHtcbiAgICAgICAgdXJsOiAnL3ZlaGljbGVzLzppZCcsICAgICAgICBcbiBcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAgICdjb250ZW50QCc6IHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZlaGljbGVzL2VkaXRWZWhpY2xlLmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdWZWhpY2xlc0VkaXRJbmZvQ3RybCcgICAgICAgIFxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gXG4gICAgfSlcblxuICAgICAuc3RhdGUoJ2FwcC5ob21lLm1hcCcsIHtcbiAgICAgICAgdXJsOiAnL3ZlaGljbGVzL21hcC86aWQnLCAgICAgICAgXG4gXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgICAnY29udGVudEAnOiB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2ZWhpY2xlcy9tYXBWZWhpY2xlLmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdWZWhpY2xlc0VkaXRNYXBDdHJsJyAgICAgICAgXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiBcbiAgICB9KVxuXG5cbiAgICBcbiBcbiAgICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSlcbiBcbn0pO1xuXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbiAgICAuc2VydmljZSgnYXV0aCcsIGZ1bmN0aW9uKCRodHRwLCAkd2luZG93LCAkbG9jYXRpb24sICRyb290U2NvcGUpIHtcblxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBnZXRVc2VyOiBnZXRVc2VyLFxuICAgICAgICAgICAgbG9naW46IGxvZ2luLFxuICAgICAgICAgICAgbG9nb3V0OiBsb2dvdXQsXG4gICAgICAgICAgICBzdG9yZVRva2VuOiBzdG9yZVRva2VuLFxuICAgICAgICAgICAgaXNMb2dnZWQ6IGlzTG9nZ2VkLFxuICAgICAgICAgICAgcG9zdExvZ2luT3BzOiBwb3N0TG9naW5PcHMsXG4gICAgICAgICAgICBwb3N0TG9naW5Sb3V0ZUhhbmRsZXI6IHBvc3RMb2dpblJvdXRlSGFuZGxlclxuXG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRVc2VyKCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgnYXBpL3VzZXJzJylcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGxvZ2luKHVzZXJuYW1lLCBwYXNzd29yZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgnYXBpL3Nlc3Npb25zJywge1xuICAgICAgICAgICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZSxcbiAgICAgICAgICAgICAgICBwYXNzd29yZDogcGFzc3dvcmRcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cblxuXG4gICAgICAgIGZ1bmN0aW9uIGxvZ291dCgpIHtcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCd1c2VyX3Rva2VuJyk7XG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnbG9nZ2VkX3VzZXInKTtcbiAgICAgICAgICAgIGRlbGV0ZSAkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsneC1hdXRoJ11cbiAgICAgICAgICAgICRyb290U2NvcGUuaXNMb2dnZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICRyb290U2NvcGUuY3VycmVudFVzZXIgPSBudWxsO1xuICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvbG9naW5cIilcblxuXG5cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHN0b3JlVG9rZW4ocmVzLCBjYikge1xuICAgICAgICAgICAgJHdpbmRvdy5zZXNzaW9uU3RvcmFnZVtcInVzZXJfdG9rZW5cIl0gPSByZXNcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd1c2VyX3Rva2VuJywgcmVzKTtcbiAgICAgICAgICAgICRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWyd4LWF1dGgnXSA9ICR3aW5kb3cuc2Vzc2lvblN0b3JhZ2UudXNlcl90b2tlblxuICAgICAgICAgICAgaWYgKGNiICYmICh0eXBlb2YgY2IgPT09ICdmdW5jdGlvbicpKSB7XG4gICAgICAgICAgICAgICAgY2IoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGlzTG9nZ2VkKCkge1xuXG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBwb3N0TG9naW5PcHMocmVzLCBjYikge1xuXG4gICAgICAgICAgICBcbiAgICAgICAgICAgICRyb290U2NvcGUuY3VycmVudFVzZXIgPSByZXMubmFtZVxuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2xvZ2dlZF91c2VyJywgJHJvb3RTY29wZS5jdXJyZW50VXNlcilcbiAgICAgICAgICAgICRyb290U2NvcGUuaXNMb2dnZWQgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKGNiICYmICh0eXBlb2YgY2IgPT09ICdmdW5jdGlvbicpKSB7XG4gICAgICAgICAgICAgICAgY2IoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gcG9zdExvZ2luUm91dGVIYW5kbGVyKCkge1xuICAgICAgICAgICAgaWYgKCRyb290U2NvcGUuaW50ZW5kZWRSb3V0ZSkge1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCRyb290U2NvcGUuaW50ZW5kZWRSb3V0ZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvaG9tZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuXG4gICAgfSlcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
