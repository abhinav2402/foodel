angular.module("app",["ngRoute","ui.router"]),angular.module("app").controller("errorCtrl",["$scope","$rootScope",function(e,o){e.hello="this is from the controller hello",console.log(e.hello)}]),angular.module("app").controller("homeCtrl",["$scope","$http",function(e,o){e.model={},e.markonGoogleMap=function(){"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(function(o){console.log(o.coords.latitude,o.coords.longitude);var t=o.coords.latitude,l=o.coords.longitude,n=new google.maps.Geocoder,r=new google.maps.LatLng(t,l);n.geocode({latLng:r},function(o,t){if(t==google.maps.GeocoderStatus.OK){if(o[0])for(var l=o[0].address_components,n=0;n<l.length;n++){if("sublocality_level_3"==l[n].types[0])var r=l[n].long_name;if("sublocality_level_2"==l[n].types[0])var a=l[n].long_name;if("sublocality_level_1"==l[n].types[0])var i=l[n].long_name;if("locality"==l[n].types[0])var s=l[n].long_name;if("administrative_area_level_1"==l[n].types[0])var c=l[n].long_name;if("country"==l[n].types[0]){var u=l[n].long_name;console.log(u)}if("postal_code"==l[n].types[0]){var m=l[n].long_name;console.log(m)}}e.model.area=r+", "+a+", "+i+", "+s+", "+c+", "+u,e.$digest(),console.log(e.model.area),console.log(l)}})});var o=document.getElementById("place"),t=new google.maps.places.Autocomplete(o);google.maps.event.addListener(t,"place_changed",function(){var e=t.getPlace();return e.geometry?void console.log(e):void window.alert("Autocomplete's returned place contains no geometry")})},e.model.qitem1=0,e.model.qitem2=0,e.addItem=function(o){if(1==o){if(8==e.model.qitem1)return void alert("Maximum limit reached");e.model.qitem1++}else if(2==o){if(8==e.model.qitem2)return void alert("Maximum limit reached");e.model.qitem2++}},e.removeItem=function(o){if(1==o){if(0==e.model.qitem1)return void alert("You have not added this item to cart");e.model.qitem1--}else if(2==o){if(0==e.model.qitem2)return void alert("You have not added this item to cart");e.model.qitem2--}},e.markonGoogleMap()}]),angular.module("app").controller("loginCtrl",["$scope","auth","$location","$timeout",function(e,o,t,l){e.authFail=!1,e.login=function(t,n){o.login(t,n).then(function(e){o.storeToken(e.data,function(){o.getUser().then(function(e){o.postLoginOps(e.data,function(){o.postLoginRouteHandler()})})})})["catch"](function(o){console.error("Gists error",o.status,o.data),401==o.status&&(e.authFail=!0,l(function(){e.authFail=!1},3e3))})["finally"](function(){console.log("finally finished gists")})}}]),angular.module("app").controller("masterCtrl",["$scope","$rootScope","$route",function(e,o,t){console.log("masterCtrl"),localStorage.getItem("logged_user")&&(o.currentUser=localStorage.getItem("logged_user")),e.$on("login",function(t,l){console.log("Logged In"),e.currentUser=l,o.currentUser=l,localStorage.setItem("logged_user",o.currentUser.username)})}]),angular.module("app").controller("navCtrl",["$scope","auth","$location",function(e,o,t){e.logout=function(){o.logout()}}]),angular.module("app").controller("PostsCtrl",["$scope","PostsSvc",function(e,o){o.fetch().success(function(o){e.posts=o}),e.addPost=function(){e.postBody&&o.create({body:e.postBody}).success(function(o){e.postBody=null})},e.$on("ws:new_post",function(o,t){e.$apply(function(){e.posts.unshift(t)})})}]),angular.module("app").service("PostsSvc",["$http",function(e){this.fetch=function(){return e.get("/api/posts")},this.create=function(o){return e.post("/api/posts",o)}}]),angular.module("app").controller("registerCtrl",["$scope","auth","$location",function(e,o,t){e.register=function(l,n,r){o.register(l,n,r).then(function(o){e.$emit("login",o.data),t.path("/home")})["catch"](function(e){console.log(e)})}}]),angular.module("app").config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,o,t){o.otherwise("/"),e.state("app",{url:"/",views:{header:{templateUrl:"/nav.html",controller:"navCtrl"},content:{templateUrl:"users/home.html",controller:"homeCtrl"}}}).state("app.login",{url:"login",views:{header:{templateUrl:"/nav.html",controller:"navCtrl"},content:{templateUrl:"/login.html",controller:"loginCtrl"}}}).state("app.register",{url:"register",views:{"content@":{templateUrl:"register.html",controller:"registerCtrl"}}}).state("app.home",{url:"home",views:{"content@":{templateUrl:"users/home.html",controller:"homeCtrl"}}}).state("app.home.vehicles",{url:"/vehicles/new",views:{"content@":{templateUrl:"vehicles/newVehicle.html",controller:"VehiclesNewInfoCtrl"}}}).state("app.home.details",{url:"/vehicles/:id",views:{"content@":{templateUrl:"vehicles/editVehicle.html",controller:"VehiclesEditInfoCtrl"}}}).state("app.home.map",{url:"/vehicles/map/:id",views:{"content@":{templateUrl:"vehicles/mapVehicle.html",controller:"VehiclesEditMapCtrl"}}}),t.html5Mode(!0)}]),angular.module("app").service("auth",["$http","$window","$location","$rootScope",function(e,o,t,l){function n(){return e.get("api/users")}function r(o,t){return e.post("api/sessions",{username:o,password:t})}function a(){localStorage.removeItem("user_token"),localStorage.removeItem("logged_user"),delete e.defaults.headers.common["x-auth"],l.isLogged=!1,l.currentUser=null,t.path("/login")}function i(t,l){o.sessionStorage.user_token=t,localStorage.setItem("user_token",t),e.defaults.headers.common["x-auth"]=o.sessionStorage.user_token,l&&"function"==typeof l&&l()}function s(){}function c(e,o){l.currentUser=e.name,localStorage.setItem("logged_user",l.currentUser),l.isLogged=!0,o&&"function"==typeof o&&o()}function u(){l.intendedRoute?t.path(l.intendedRoute):t.path("/home")}return{getUser:n,login:r,logout:a,storeToken:i,isLogged:s,postLoginOps:c,postLoginRouteHandler:u}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImNvbnRyb2xsZXJzL2Vycm9yQ3RybC5qcyIsImNvbnRyb2xsZXJzL2hvbWVDdHJsLmpzIiwiY29udHJvbGxlcnMvbG9naW5DdHJsLmpzIiwiY29udHJvbGxlcnMvbWFzdGVyQ3RybC5qcyIsImNvbnRyb2xsZXJzL25hdkN0cmwuanMiLCJjb250cm9sbGVycy9wb3N0cy5jdHJsLmpzIiwiY29udHJvbGxlcnMvcG9zdHMuc3ZjLmpzIiwiY29udHJvbGxlcnMvcmVnaXN0ZXJDdHJsLmpzIiwiY29udHJvbGxlcnMvcm91dGVzLmpzIiwic2VydmljZXMvYXV0aC5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29udHJvbGxlciIsIiRzY29wZSIsIiRyb290U2NvcGUiLCJoZWxsbyIsImNvbnNvbGUiLCJsb2ciLCIkaHR0cCIsIm1vZGVsIiwibWFya29uR29vZ2xlTWFwIiwibmF2aWdhdG9yIiwiZ2VvbG9jYXRpb24iLCJnZXRDdXJyZW50UG9zaXRpb24iLCJwb3NpdGlvbiIsImNvb3JkcyIsImxhdGl0dWRlIiwibG9uZ2l0dWRlIiwiZ2VvY29kZXIiLCJnb29nbGUiLCJtYXBzIiwiR2VvY29kZXIiLCJsYXRsbmciLCJMYXRMbmciLCJnZW9jb2RlIiwibGF0TG5nIiwicmVzdWx0cyIsInN0YXR1cyIsIkdlb2NvZGVyU3RhdHVzIiwiT0siLCJjb21wb25lbnRzIiwiYWRkcmVzc19jb21wb25lbnRzIiwiY29tcG9uZW50IiwidHlwZXMiLCJzdWJfbG9jYWxpdHkzIiwibG9uZ19uYW1lIiwic3ViX2xvY2FsaXR5MiIsInN1Yl9sb2NhbGl0eTEiLCJsb2NhbGl0eSIsImFkbWluX2FyZWEiLCJjb3VudHJ5IiwicG9zdGFsX2NvZGUiLCJhcmVhIiwiJGRpZ2VzdCIsImlucHV0IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImF1dG9jb21wbGV0ZSIsInBsYWNlcyIsIkF1dG9jb21wbGV0ZSIsImV2ZW50IiwiYWRkTGlzdGVuZXIiLCJwbGFjZSIsImdldFBsYWNlIiwiZ2VvbWV0cnkiLCJ3aW5kb3ciLCJhbGVydCIsInFpdGVtMSIsInFpdGVtMiIsImFkZEl0ZW0iLCJkaXNoIiwicmVtb3ZlSXRlbSIsImF1dGgiLCIkbG9jYXRpb24iLCIkdGltZW91dCIsImF1dGhGYWlsIiwibG9naW4iLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwidGhlbiIsInJlcyIsInN0b3JlVG9rZW4iLCJkYXRhIiwiZ2V0VXNlciIsInBvc3RMb2dpbk9wcyIsInBvc3RMb2dpblJvdXRlSGFuZGxlciIsInJlc3BvbnNlIiwiZXJyb3IiLCIkcm91dGUiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwiY3VycmVudFVzZXIiLCIkb24iLCJfIiwidXNlciIsInNldEl0ZW0iLCJsb2dvdXQiLCJQb3N0c1N2YyIsImZldGNoIiwic3VjY2VzcyIsInBvc3RzIiwiYWRkUG9zdCIsInBvc3RCb2R5IiwiY3JlYXRlIiwiYm9keSIsInBvc3QiLCIkYXBwbHkiLCJ1bnNoaWZ0Iiwic2VydmljZSIsInRoaXMiLCJnZXQiLCJyZWdpc3RlciIsIm5hbWUiLCIkZW1pdCIsInBhdGgiLCJlcnIiLCJjb25maWciLCIkc3RhdGVQcm92aWRlciIsIiR1cmxSb3V0ZXJQcm92aWRlciIsIiRsb2NhdGlvblByb3ZpZGVyIiwib3RoZXJ3aXNlIiwic3RhdGUiLCJ1cmwiLCJ2aWV3cyIsImhlYWRlciIsInRlbXBsYXRlVXJsIiwiY29udGVudCIsImNvbnRlbnRAIiwiaHRtbDVNb2RlIiwiJHdpbmRvdyIsImRlZmF1bHRzIiwiaGVhZGVycyIsImNvbW1vbiIsImlzTG9nZ2VkIiwiY2IiLCJzZXNzaW9uU3RvcmFnZSIsInVzZXJfdG9rZW4iLCJpbnRlbmRlZFJvdXRlIl0sIm1hcHBpbmdzIjoiQUFBQUEsUUFBQUMsT0FBQSxPQUNBLFVBQUEsY0NEQUQsUUFBQUMsT0FBQSxPQUNBQyxXQUFBLGFBQUEsU0FBQSxhQUFBLFNBQUFDLEVBQUFDLEdBQ0FELEVBQUFFLE1BQUEsb0NBQ0FDLFFBQUFDLElBQUFKLEVBQUFFLFVDSEFMLFFBQUFDLE9BQUEsT0FDQUMsV0FBQSxZQUFBLFNBQUEsUUFBQSxTQUFBQyxFQUFBSyxHQUNBTCxFQUFBTSxTQUVBTixFQUFBTyxnQkFBQSxXQUNBLGVBQUFDLFlBQ0FBLFVBQUFDLFlBQUFDLG1CQUFBLFNBQUFDLEdBQ0FSLFFBQUFDLElBQUFPLEVBQUFDLE9BQUFDLFNBQUFGLEVBQUFDLE9BQUFFLFVBQ0EsSUFBQUQsR0FBQUYsRUFBQUMsT0FBQUMsU0FDQUMsRUFBQUgsRUFBQUMsT0FBQUUsVUFDQUMsRUFBQSxHQUFBQyxRQUFBQyxLQUFBQyxTQUdBQyxFQUFBLEdBQUFILFFBQUFDLEtBQUFHLE9BQUFQLEVBQUFDLEVBQ0FDLEdBQUFNLFNBQUFDLE9BQUFILEdBQUEsU0FBQUksRUFBQUMsR0FDQSxHQUFBQSxHQUFBUixPQUFBQyxLQUFBUSxlQUFBQyxHQUFBLENBQ0EsR0FBQUgsRUFBQSxHQUVBLElBQUEsR0FEQUksR0FBQUosRUFBQSxHQUFBSyxtQkFDQUMsRUFBQSxFQUFBQSxFQUFBRixFQUFBLE9BQUFFLElBQUEsQ0FDQSxHQUFBLHVCQUFBRixFQUFBRSxHQUFBQyxNQUFBLEdBQ0EsR0FBQUMsR0FBQUosRUFBQUUsR0FBQUcsU0FHQSxJQUFBLHVCQUFBTCxFQUFBRSxHQUFBQyxNQUFBLEdBQ0EsR0FBQUcsR0FBQU4sRUFBQUUsR0FBQUcsU0FHQSxJQUFBLHVCQUFBTCxFQUFBRSxHQUFBQyxNQUFBLEdBQ0EsR0FBQUksR0FBQVAsRUFBQUUsR0FBQUcsU0FHQSxJQUFBLFlBQUFMLEVBQUFFLEdBQUFDLE1BQUEsR0FDQSxHQUFBSyxHQUFBUixFQUFBRSxHQUFBRyxTQUdBLElBQUEsK0JBQUFMLEVBQUFFLEdBQUFDLE1BQUEsR0FDQSxHQUFBTSxHQUFBVCxFQUFBRSxHQUFBRyxTQUVBLElBQUEsV0FBQUwsRUFBQUUsR0FBQUMsTUFBQSxHQUFBLENBQ0EsR0FBQU8sR0FBQVYsRUFBQUUsR0FBQUcsU0FDQTdCLFNBQUFDLElBQUFpQyxHQUdBLEdBQUEsZUFBQVYsRUFBQUUsR0FBQUMsTUFBQSxHQUFBLENBQ0EsR0FBQVEsR0FBQVgsRUFBQUUsR0FBQUcsU0FDQTdCLFNBQUFDLElBQUFrQyxJQUlBdEMsRUFBQU0sTUFBQWlDLEtBQUFSLEVBQUEsS0FBQUUsRUFBQSxLQUFBQyxFQUFBLEtBQUFDLEVBQUEsS0FBQUMsRUFBQSxLQUFBQyxFQUNBckMsRUFBQXdDLFVBQ0FyQyxRQUFBQyxJQUFBSixFQUFBTSxNQUFBaUMsTUFDQXBDLFFBQUFDLElBQUF1QixPQVVBLElBQUFjLEdBQUFDLFNBQUFDLGVBQUEsU0FDQUMsRUFBQSxHQUFBNUIsUUFBQUMsS0FBQTRCLE9BQUFDLGFBQUFMLEVBRUF6QixRQUFBQyxLQUFBOEIsTUFBQUMsWUFBQUosRUFBQSxnQkFBQSxXQUNBLEdBQUFLLEdBQUFMLEVBQUFNLFVBQ0EsT0FBQUQsR0FBQUUsYUFLQWhELFNBQUFDLElBQUE2QyxPQUpBRyxRQUFBQyxNQUFBLHlEQVlBckQsRUFBQU0sTUFBQWdELE9BQUEsRUFDQXRELEVBQUFNLE1BQUFpRCxPQUFBLEVBRUF2RCxFQUFBd0QsUUFBQSxTQUFBQyxHQUNBLEdBQUEsR0FBQUEsRUFBQSxDQUVBLEdBQUEsR0FBQXpELEVBQUFNLE1BQUFnRCxPQUVBLFdBREFELE9BQUEsd0JBR0FyRCxHQUFBTSxNQUFBZ0QsYUFDQSxJQUFBLEdBQUFHLEVBQUEsQ0FDQSxHQUFBLEdBQUF6RCxFQUFBTSxNQUFBaUQsT0FFQSxXQURBRixPQUFBLHdCQUdBckQsR0FBQU0sTUFBQWlELFdBS0F2RCxFQUFBMEQsV0FBQSxTQUFBRCxHQUNBLEdBQUEsR0FBQUEsRUFBQSxDQUVBLEdBQUEsR0FBQXpELEVBQUFNLE1BQUFnRCxPQUVBLFdBREFELE9BQUEsdUNBR0FyRCxHQUFBTSxNQUFBZ0QsYUFDQSxJQUFBLEdBQUFHLEVBQUEsQ0FDQSxHQUFBLEdBQUF6RCxFQUFBTSxNQUFBaUQsT0FFQSxXQURBRixPQUFBLHVDQUdBckQsR0FBQU0sTUFBQWlELFdBS0F2RCxFQUFBTyxxQkN2SEFWLFFBQUFDLE9BQUEsT0FDQUMsV0FBQSxhQUFBLFNBQUEsT0FBQSxZQUFBLFdBQUEsU0FBQUMsRUFBQTJELEVBQUFDLEVBQUFDLEdBQ0E3RCxFQUFBOEQsVUFBQSxFQUNBOUQsRUFBQStELE1BQUEsU0FBQUMsRUFBQUMsR0FDQU4sRUFBQUksTUFBQUMsRUFBQUMsR0FDQUMsS0FBQSxTQUFBQyxHQUNBUixFQUFBUyxXQUFBRCxFQUFBRSxLQUFBLFdBQ0FWLEVBQUFXLFVBQ0FKLEtBQUEsU0FBQUMsR0FDQVIsRUFBQVksYUFBQUosRUFBQUUsS0FBQSxXQUNBVixFQUFBYSxnQ0FOQWIsU0FZQSxTQUFBYyxHQUNBdEUsUUFBQXVFLE1BQUEsY0FBQUQsRUFBQWpELE9BQUFpRCxFQUFBSixNQUNBLEtBQUFJLEVBQUFqRCxTQUNBeEIsRUFBQThELFVBQUEsRUFDQUQsRUFBQSxXQUFBN0QsRUFBQThELFVBQUEsR0FBQSxRQWhCQUgsV0FtQkEsV0FDQXhELFFBQUFDLElBQUEsZ0NDeEJBUCxRQUFBQyxPQUFBLE9BQ0FDLFdBQUEsY0FBQSxTQUFBLGFBQUEsU0FBQSxTQUFBQyxFQUFBQyxFQUFBMEUsR0FDQXhFLFFBQUFDLElBQUEsY0FFQXdFLGFBQUFDLFFBQUEsaUJBQ0E1RSxFQUFBNkUsWUFBQUYsYUFBQUMsUUFBQSxnQkFFQTdFLEVBQUErRSxJQUFBLFFBQUEsU0FBQUMsRUFBQUMsR0FDQTlFLFFBQUFDLElBQUEsYUFDQUosRUFBQThFLFlBQUFHLEVBQ0FoRixFQUFBNkUsWUFBQUcsRUFDQUwsYUFBQU0sUUFBQSxjQUFBakYsRUFBQTZFLFlBQUFkLGVDWEFuRSxRQUFBQyxPQUFBLE9BQ0FDLFdBQUEsV0FBQSxTQUFBLE9BQUEsWUFBQSxTQUFBQyxFQUFBMkQsRUFBQUMsR0FDQTVELEVBQUFtRixPQUFBLFdBQ0F4QixFQUFBd0IsYUNIQXRGLFFBQUFDLE9BQUEsT0FDQUMsV0FBQSxhQUFBLFNBQUEsV0FBQSxTQUFBQyxFQUFBb0YsR0FDQUEsRUFBQUMsUUFDQUMsUUFBQSxTQUFBQyxHQUNBdkYsRUFBQXVGLE1BQUFBLElBSUF2RixFQUFBd0YsUUFBQSxXQUNBeEYsRUFBQXlGLFVBQ0FMLEVBQUFNLFFBRUFDLEtBQUEzRixFQUFBeUYsV0FDQUgsUUFBQSxTQUFBTSxHQUVBNUYsRUFBQXlGLFNBQUEsUUFLQXpGLEVBQUErRSxJQUFBLGNBQUEsU0FBQUMsRUFBQVksR0FDQTVGLEVBQUE2RixPQUFBLFdBQ0E3RixFQUFBdUYsTUFBQU8sUUFBQUYsVUN0QkEvRixRQUFBQyxPQUFBLE9BQ0FpRyxRQUFBLFlBQUEsUUFBQSxTQUFBMUYsR0FDQTJGLEtBQUFYLE1BQUEsV0FDQSxNQUFBaEYsR0FBQTRGLElBQUEsZUFFQUQsS0FBQU4sT0FBQSxTQUFBRSxHQUVBLE1BQUF2RixHQUFBdUYsS0FBQSxhQUFBQSxPQ1BBL0YsUUFBQUMsT0FBQSxPQUNBQyxXQUFBLGdCQUFBLFNBQUEsT0FBQSxZQUFBLFNBQUFDLEVBQUEyRCxFQUFBQyxHQUNBNUQsRUFBQWtHLFNBQUEsU0FBQUMsRUFBQW5DLEVBQUFDLEdBQ0FOLEVBQUF1QyxTQUFBQyxFQUFBbkMsRUFBQUMsR0FDQUMsS0FBQSxTQUFBTyxHQUNBekUsRUFBQW9HLE1BQUEsUUFBQTNCLEVBQUFKLE1BQ0FULEVBQUF5QyxLQUFBLFdBSEExQyxTQUtBLFNBQUEyQyxHQUNBbkcsUUFBQUMsSUFBQWtHLFNDVEF6RyxRQUFBQyxPQUFBLE9BQ0F5RyxRQUFBLGlCQUFBLHFCQUFBLG9CQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEdBRUFELEVBQUFFLFVBQUEsS0FFQUgsRUFDQUksTUFBQSxPQUNBQyxJQUFBLElBQ0FDLE9BQ0FDLFFBQ0FDLFlBQUEsWUFDQWpILFdBQUEsV0FFQWtILFNBQ0FELFlBQUEsa0JBQ0FqSCxXQUFBLGVBS0E2RyxNQUFBLGFBQ0FDLElBQUEsUUFDQUMsT0FDQUMsUUFDQUMsWUFBQSxZQUNBakgsV0FBQSxXQUVBa0gsU0FDQUQsWUFBQSxjQUNBakgsV0FBQSxnQkFNQTZHLE1BQUEsZ0JBQ0FDLElBQUEsV0FDQUMsT0FDQUksWUFDQUYsWUFBQSxnQkFDQWpILFdBQUEsbUJBTUE2RyxNQUFBLFlBQ0FDLElBQUEsT0FDQUMsT0FDQUksWUFDQUYsWUFBQSxrQkFDQWpILFdBQUEsZUFNQTZHLE1BQUEscUJBQ0FDLElBQUEsZ0JBQ0FDLE9BQ0FJLFlBQ0FGLFlBQUEsMkJBQ0FqSCxXQUFBLDBCQU1BNkcsTUFBQSxvQkFDQUMsSUFBQSxnQkFFQUMsT0FDQUksWUFDQUYsWUFBQSw0QkFDQWpILFdBQUEsMkJBTUE2RyxNQUFBLGdCQUNBQyxJQUFBLG9CQUVBQyxPQUNBSSxZQUNBRixZQUFBLDJCQUNBakgsV0FBQSwwQkFTQTJHLEVBQUFTLFdBQUEsTUMvRkF0SCxRQUFBQyxPQUFBLE9BQ0FpRyxRQUFBLFFBQUEsUUFBQSxVQUFBLFlBQUEsYUFBQSxTQUFBMUYsRUFBQStHLEVBQUF4RCxFQUFBM0QsR0FjQSxRQUFBcUUsS0FDQSxNQUFBakUsR0FBQTRGLElBQUEsYUFHQSxRQUFBbEMsR0FBQUMsRUFBQUMsR0FFQSxNQUFBNUQsR0FBQXVGLEtBQUEsZ0JBQ0E1QixTQUFBQSxFQUNBQyxTQUFBQSxJQUtBLFFBQUFrQixLQUNBUCxhQUFBbEIsV0FBQSxjQUNBa0IsYUFBQWxCLFdBQUEscUJBQ0FyRCxHQUFBZ0gsU0FBQUMsUUFBQUMsT0FBQSxVQUNBdEgsRUFBQXVILFVBQUEsRUFDQXZILEVBQUE2RSxZQUFBLEtBQ0FsQixFQUFBeUMsS0FBQSxVQU1BLFFBQUFqQyxHQUFBRCxFQUFBc0QsR0FDQUwsRUFBQU0sZUFBQSxXQUFBdkQsRUFDQVMsYUFBQU0sUUFBQSxhQUFBZixHQUNBOUQsRUFBQWdILFNBQUFDLFFBQUFDLE9BQUEsVUFBQUgsRUFBQU0sZUFBQUMsV0FDQUYsR0FBQSxrQkFBQUEsSUFDQUEsSUFJQSxRQUFBRCxNQUlBLFFBQUFqRCxHQUFBSixFQUFBc0QsR0FHQXhILEVBQUE2RSxZQUFBWCxFQUFBZ0MsS0FDQXZCLGFBQUFNLFFBQUEsY0FBQWpGLEVBQUE2RSxhQUNBN0UsRUFBQXVILFVBQUEsRUFDQUMsR0FBQSxrQkFBQUEsSUFDQUEsSUFLQSxRQUFBakQsS0FDQXZFLEVBQUEySCxjQUNBaEUsRUFBQXlDLEtBQUFwRyxFQUFBMkgsZUFFQWhFLEVBQUF5QyxLQUFBLFNBakVBLE9BQ0EvQixRQUFBQSxFQUNBUCxNQUFBQSxFQUNBb0IsT0FBQUEsRUFDQWYsV0FBQUEsRUFDQW9ELFNBQUFBLEVBQ0FqRCxhQUFBQSxFQUNBQyxzQkFBQUEiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2FwcCcsW1xuJ25nUm91dGUnLCd1aS5yb3V0ZXInXG5dKSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuICAgIC5jb250cm9sbGVyKCdlcnJvckN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRyb290U2NvcGUpIHtcbiAgICAgICAgJHNjb3BlLmhlbGxvID0gXCJ0aGlzIGlzIGZyb20gdGhlIGNvbnRyb2xsZXIgaGVsbG9cIlxuICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUuaGVsbG8pXG5cblxuXG4gICAgfSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuICAgIC5jb250cm9sbGVyKCdob21lQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHApIHtcbiAgICAgICAgJHNjb3BlLm1vZGVsID0ge31cblxuICAgICAgICAkc2NvcGUubWFya29uR29vZ2xlTWFwID0gZnVuY3Rpb24gaW5pdGlhbGl6ZSgpIHtcbiAgICAgICAgICAgIGlmIChcImdlb2xvY2F0aW9uXCIgaW4gbmF2aWdhdG9yKSB7XG4gICAgICAgICAgICAgICAgbmF2aWdhdG9yLmdlb2xvY2F0aW9uLmdldEN1cnJlbnRQb3NpdGlvbihmdW5jdGlvbihwb3NpdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhwb3NpdGlvbi5jb29yZHMubGF0aXR1ZGUsIHBvc2l0aW9uLmNvb3Jkcy5sb25naXR1ZGUpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGF0aXR1ZGUgPSBwb3NpdGlvbi5jb29yZHMubGF0aXR1ZGU7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsb25naXR1ZGUgPSBwb3NpdGlvbi5jb29yZHMubG9uZ2l0dWRlO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ2VvY29kZXIgPSBuZXcgZ29vZ2xlLm1hcHMuR2VvY29kZXIoKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBSZXZlcnNlIEdlb2NvZGluZywgTG9jYXRpb24gbmFtZSBmcm9tIGNvLW9yZGluYXRlcy5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGxhdGxuZyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcobGF0aXR1ZGUsIGxvbmdpdHVkZSk7XG4gICAgICAgICAgICAgICAgICAgIGdlb2NvZGVyLmdlb2NvZGUoeyAnbGF0TG5nJzogbGF0bG5nIH0sIGZ1bmN0aW9uKHJlc3VsdHMsIHN0YXR1cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXR1cyA9PSBnb29nbGUubWFwcy5HZW9jb2RlclN0YXR1cy5PSykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHRzWzBdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb21wb25lbnRzID0gcmVzdWx0c1swXS5hZGRyZXNzX2NvbXBvbmVudHM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGNvbXBvbmVudCA9IDA7IGNvbXBvbmVudCA8IChjb21wb25lbnRzLmxlbmd0aCk7IGNvbXBvbmVudCsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29tcG9uZW50c1tjb21wb25lbnRdLnR5cGVzWzBdID09IFwic3VibG9jYWxpdHlfbGV2ZWxfM1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Yl9sb2NhbGl0eTMgPSBjb21wb25lbnRzW2NvbXBvbmVudF0ubG9uZ19uYW1lO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29tcG9uZW50c1tjb21wb25lbnRdLnR5cGVzWzBdID09IFwic3VibG9jYWxpdHlfbGV2ZWxfMlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Yl9sb2NhbGl0eTIgPSBjb21wb25lbnRzW2NvbXBvbmVudF0ubG9uZ19uYW1lO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29tcG9uZW50c1tjb21wb25lbnRdLnR5cGVzWzBdID09IFwic3VibG9jYWxpdHlfbGV2ZWxfMVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Yl9sb2NhbGl0eTEgPSBjb21wb25lbnRzW2NvbXBvbmVudF0ubG9uZ19uYW1lO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29tcG9uZW50c1tjb21wb25lbnRdLnR5cGVzWzBdID09IFwibG9jYWxpdHlcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsb2NhbGl0eSA9IGNvbXBvbmVudHNbY29tcG9uZW50XS5sb25nX25hbWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb21wb25lbnRzW2NvbXBvbmVudF0udHlwZXNbMF0gPT0gXCJhZG1pbmlzdHJhdGl2ZV9hcmVhX2xldmVsXzFcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhZG1pbl9hcmVhID0gY29tcG9uZW50c1tjb21wb25lbnRdLmxvbmdfbmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb21wb25lbnRzW2NvbXBvbmVudF0udHlwZXNbMF0gPT0gXCJjb3VudHJ5XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY291bnRyeSA9IGNvbXBvbmVudHNbY29tcG9uZW50XS5sb25nX25hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coY291bnRyeSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbXBvbmVudHNbY29tcG9uZW50XS50eXBlc1swXSA9PSBcInBvc3RhbF9jb2RlXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcG9zdGFsX2NvZGUgPSBjb21wb25lbnRzW2NvbXBvbmVudF0ubG9uZ19uYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHBvc3RhbF9jb2RlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5tb2RlbC5hcmVhID0gc3ViX2xvY2FsaXR5MyArICcsICcgKyBzdWJfbG9jYWxpdHkyICsgJywgJyArIHN1Yl9sb2NhbGl0eTEgKyAnLCAnICsgbG9jYWxpdHkgKyAnLCAnICsgYWRtaW5fYXJlYSArICcsICcgKyBjb3VudHJ5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRkaWdlc3QoKTsgLy8gZmluZCBhIGJldHRlciB3YXkgdG8gZG8gdGhpcywgbWF5IGJlIGNhbGxiYWNrXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLm1vZGVsLmFyZWEpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coY29tcG9uZW50cylcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLyogZ2VvbG9jYXRpb24gSVMgTk9UIGF2YWlsYWJsZSAqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BsYWNlJyk7XG4gICAgICAgICAgICB2YXIgYXV0b2NvbXBsZXRlID0gbmV3IGdvb2dsZS5tYXBzLnBsYWNlcy5BdXRvY29tcGxldGUoaW5wdXQpO1xuICAgICAgICAgICAgLy9hdXRvY29tcGxldGUuYmluZFRvKCdib3VuZHMnLCBtYXApOyBpZiBib3VuZCBuZWVkcyB0byBiZSBzZXQgdG8gYmlhcyBzZWFyY2hcbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKGF1dG9jb21wbGV0ZSwgJ3BsYWNlX2NoYW5nZWQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGxhY2UgPSBhdXRvY29tcGxldGUuZ2V0UGxhY2UoKTtcbiAgICAgICAgICAgICAgICBpZiAoIXBsYWNlLmdlb21ldHJ5KSB7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5hbGVydChcIkF1dG9jb21wbGV0ZSdzIHJldHVybmVkIHBsYWNlIGNvbnRhaW5zIG5vIGdlb21ldHJ5XCIpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhwbGFjZSk7XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9XG5cblxuICAgICAgICAkc2NvcGUubW9kZWwucWl0ZW0xID0gMDtcbiAgICAgICAgJHNjb3BlLm1vZGVsLnFpdGVtMiA9IDA7XG5cbiAgICAgICAgJHNjb3BlLmFkZEl0ZW0gPSBmdW5jdGlvbihkaXNoKSB7XG4gICAgICAgICAgICBpZiAoZGlzaCA9PSAxKSB7XG5cbiAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLm1vZGVsLnFpdGVtMSA9PSA4KSB7XG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwiTWF4aW11bSBsaW1pdCByZWFjaGVkXCIpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLm1vZGVsLnFpdGVtMSsrO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChkaXNoID09IDIpIHtcbiAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLm1vZGVsLnFpdGVtMiA9PSA4KSB7XG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwiTWF4aW11bSBsaW1pdCByZWFjaGVkXCIpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLm1vZGVsLnFpdGVtMisrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cblxuICAgICAgICAkc2NvcGUucmVtb3ZlSXRlbSA9IGZ1bmN0aW9uKGRpc2gpIHtcbiAgICAgICAgICAgIGlmIChkaXNoID09IDEpIHtcblxuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUubW9kZWwucWl0ZW0xID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCJZb3UgaGF2ZSBub3QgYWRkZWQgdGhpcyBpdGVtIHRvIGNhcnRcIik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUubW9kZWwucWl0ZW0xLS07XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRpc2ggPT0gMikge1xuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUubW9kZWwucWl0ZW0yID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCJZb3UgaGF2ZSBub3QgYWRkZWQgdGhpcyBpdGVtIHRvIGNhcnRcIik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUubW9kZWwucWl0ZW0yLS07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuXG4gICAgICAgICRzY29wZS5tYXJrb25Hb29nbGVNYXAoKTtcblxuXG5cblxuXG4gICAgfSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuICAgIC5jb250cm9sbGVyKCdsb2dpbkN0cmwnLCBmdW5jdGlvbigkc2NvcGUsIGF1dGgsICRsb2NhdGlvbiwgJHRpbWVvdXQpIHtcbiAgICAgICAgJHNjb3BlLmF1dGhGYWlsID0gZmFsc2U7XG4gICAgICAgICRzY29wZS5sb2dpbiA9IGZ1bmN0aW9uKHVzZXJuYW1lLCBwYXNzd29yZCkge1xuICAgICAgICAgICAgYXV0aC5sb2dpbih1c2VybmFtZSwgcGFzc3dvcmQpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGF1dGguc3RvcmVUb2tlbihyZXMuZGF0YSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhdXRoLmdldFVzZXIoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRoLnBvc3RMb2dpbk9wcyhyZXMuZGF0YSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRoLnBvc3RMb2dpblJvdXRlSGFuZGxlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0dpc3RzIGVycm9yJywgcmVzcG9uc2Uuc3RhdHVzLCByZXNwb25zZS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PSA0MDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hdXRoRmFpbCA9IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkgeyAkc2NvcGUuYXV0aEZhaWwgPSBmYWxzZTsgfSwgMzAwMCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5maW5hbGx5KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImZpbmFsbHkgZmluaXNoZWQgZ2lzdHNcIik7XG4gICAgICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICB9XG4gICAgfSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuICAgIC5jb250cm9sbGVyKCdtYXN0ZXJDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkcm9vdFNjb3BlLCAkcm91dGUpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJtYXN0ZXJDdHJsXCIpO1xuXG4gICAgICAgIGlmIChsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbG9nZ2VkX3VzZXInKSkgeyAgICAgICAgXHRcbiAgICAgICAgICAgICRyb290U2NvcGUuY3VycmVudFVzZXIgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbG9nZ2VkX3VzZXInKVxuICAgICAgICB9XG4gICAgICAgICRzY29wZS4kb24oJ2xvZ2luJywgZnVuY3Rpb24oXywgdXNlcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJMb2dnZWQgSW5cIik7XG4gICAgICAgICAgICAkc2NvcGUuY3VycmVudFVzZXIgPSB1c2VyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gdXNlclxuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2xvZ2dlZF91c2VyJywgJHJvb3RTY29wZS5jdXJyZW50VXNlci51c2VybmFtZSlcbiAgICAgICAgfSlcbiAgICB9KVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4gICAgLmNvbnRyb2xsZXIoJ25hdkN0cmwnLCBmdW5jdGlvbigkc2NvcGUsIGF1dGgsICRsb2NhdGlvbikgeyAgICAgICAgXG4gICAgICAgICRzY29wZS5sb2dvdXQgPSBmdW5jdGlvbigpIHsgICAgICAgICAgICBcbiAgICAgICAgICAgIGF1dGgubG9nb3V0KCkgICAgICAgICAgICAgICAgXG5cbiAgICAgICAgfVxuICAgIH0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdQb3N0c0N0cmwnLGZ1bmN0aW9uKCRzY29wZSxQb3N0c1N2Yyl7IFxuICBQb3N0c1N2Yy5mZXRjaCgpXG4gXHQuc3VjY2VzcyhmdW5jdGlvbiAocG9zdHMpe1xuIFx0XHQkc2NvcGUucG9zdHMgPSBwb3N0c1xuXG4gXHR9KVxuXHRcbiBcdCAkc2NvcGUuYWRkUG9zdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBpZiAoJHNjb3BlLnBvc3RCb2R5KSB7XG4gICAgICAgICAgICBQb3N0c1N2Yy5jcmVhdGUoe1xuICAgICAgICAgICAgICAvKnVzZXJuYW1lOiAndmlzaGFsUmFuamFuJywqL1xuICAgICAgICAgICAgICBib2R5OiAgICAgJHNjb3BlLnBvc3RCb2R5ICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH0pLnN1Y2Nlc3MoZnVuY3Rpb24gKHBvc3QpIHtcbiAgICAgICAgICAgICAgLy8kc2NvcGUucG9zdHMudW5zaGlmdChwb3N0KVxuICAgICAgICAgICAgICAkc2NvcGUucG9zdEJvZHkgPSBudWxsXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgJHNjb3BlLiRvbignd3M6bmV3X3Bvc3QnLGZ1bmN0aW9uKF8scG9zdCl7XG4gICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpe1xuICAgICAgJHNjb3BlLnBvc3RzLnVuc2hpZnQocG9zdClcbiAgICB9KVxuICB9KVxuIFxufSlcblxuICIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ1Bvc3RzU3ZjJywgZnVuY3Rpb24oJGh0dHApe1xuICAgdGhpcy5mZXRjaCA9IGZ1bmN0aW9uICgpIHsgICBcdFxuICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3Bvc3RzJylcbiAgIH1cbiAgIHRoaXMuY3JlYXRlID0gZnVuY3Rpb24gKHBvc3Qpe1xuICAgXHRcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Bvc3RzJyxwb3N0KVxuICAgfVxuIH0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcigncmVnaXN0ZXJDdHJsJyxmdW5jdGlvbigkc2NvcGUsYXV0aCAsJGxvY2F0aW9uKXtcblx0JHNjb3BlLnJlZ2lzdGVyID0gZnVuY3Rpb24obmFtZSx1c2VybmFtZSxwYXNzd29yZCl7XG5cdFx0YXV0aC5yZWdpc3RlcihuYW1lLHVzZXJuYW1lLHBhc3N3b3JkKVxuXHRcdC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXtcdFx0XHRcblx0XHRcdCRzY29wZS4kZW1pdCgnbG9naW4nLHJlc3BvbnNlLmRhdGEpXG5cdFx0XHQkbG9jYXRpb24ucGF0aCgnL2hvbWUnKVxuXHRcdH0pXG5cdFx0LmNhdGNoKGZ1bmN0aW9uIChlcnIpe1xuXHRcdFx0Y29uc29sZS5sb2coZXJyKVxuXHRcdH0pXG5cdH1cblxufSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbmZpZyhmdW5jdGlvbigkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyLCRsb2NhdGlvblByb3ZpZGVyKXtcbiBcbiAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvJyk7XG4gXG4gICAgJHN0YXRlUHJvdmlkZXJcbiAgICAuc3RhdGUoJ2FwcCcse1xuICAgICAgICB1cmw6ICcvJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAgICdoZWFkZXInOiB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvbmF2Lmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICduYXZDdHJsJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICdjb250ZW50Jzoge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndXNlcnMvaG9tZS5odG1sJyAsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ2hvbWVDdHJsJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSlcblxuICAgIC5zdGF0ZSgnYXBwLmxvZ2luJyx7XG4gICAgICAgIHVybDogJ2xvZ2luJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAgICdoZWFkZXInOiB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvbmF2Lmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICduYXZDdHJsJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICdjb250ZW50Jzoge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2xvZ2luLmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdsb2dpbkN0cmwnXG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pXG4gXG4gICAgLnN0YXRlKCdhcHAucmVnaXN0ZXInLCB7XG4gICAgICAgIHVybDogJ3JlZ2lzdGVyJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAgICdjb250ZW50QCc6IHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3JlZ2lzdGVyLmh0bWwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdyZWdpc3RlckN0cmwnXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiBcbiAgICB9KVxuIFxuICAgIC5zdGF0ZSgnYXBwLmhvbWUnLCB7XG4gICAgICAgIHVybDogJ2hvbWUnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICAgJ2NvbnRlbnRAJzoge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndXNlcnMvaG9tZS5odG1sJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnaG9tZUN0cmwnXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiBcbiAgICB9KVxuXG4gICAgIC5zdGF0ZSgnYXBwLmhvbWUudmVoaWNsZXMnLCB7XG4gICAgICAgIHVybDogJy92ZWhpY2xlcy9uZXcnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICAgJ2NvbnRlbnRAJzoge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmVoaWNsZXMvbmV3VmVoaWNsZS5odG1sJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnVmVoaWNsZXNOZXdJbmZvQ3RybCdcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuIFxuICAgIH0pXG5cbiAgICAgLnN0YXRlKCdhcHAuaG9tZS5kZXRhaWxzJywge1xuICAgICAgICB1cmw6ICcvdmVoaWNsZXMvOmlkJywgICAgICAgIFxuIFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICAgJ2NvbnRlbnRAJzoge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmVoaWNsZXMvZWRpdFZlaGljbGUuaHRtbCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1ZlaGljbGVzRWRpdEluZm9DdHJsJyAgICAgICAgXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiBcbiAgICB9KVxuXG4gICAgIC5zdGF0ZSgnYXBwLmhvbWUubWFwJywge1xuICAgICAgICB1cmw6ICcvdmVoaWNsZXMvbWFwLzppZCcsICAgICAgICBcbiBcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAgICdjb250ZW50QCc6IHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZlaGljbGVzL21hcFZlaGljbGUuaHRtbCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1ZlaGljbGVzRWRpdE1hcEN0cmwnICAgICAgICBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuIFxuICAgIH0pXG5cblxuICAgIFxuIFxuICAgICRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh0cnVlKVxuIFxufSk7XG5cbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuICAgIC5zZXJ2aWNlKCdhdXRoJywgZnVuY3Rpb24oJGh0dHAsICR3aW5kb3csICRsb2NhdGlvbiwgJHJvb3RTY29wZSkge1xuXG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGdldFVzZXI6IGdldFVzZXIsXG4gICAgICAgICAgICBsb2dpbjogbG9naW4sXG4gICAgICAgICAgICBsb2dvdXQ6IGxvZ291dCxcbiAgICAgICAgICAgIHN0b3JlVG9rZW46IHN0b3JlVG9rZW4sXG4gICAgICAgICAgICBpc0xvZ2dlZDogaXNMb2dnZWQsXG4gICAgICAgICAgICBwb3N0TG9naW5PcHM6IHBvc3RMb2dpbk9wcyxcbiAgICAgICAgICAgIHBvc3RMb2dpblJvdXRlSGFuZGxlcjogcG9zdExvZ2luUm91dGVIYW5kbGVyXG5cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldFVzZXIoKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCdhcGkvdXNlcnMnKVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gbG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KCdhcGkvc2Vzc2lvbnMnLCB7XG4gICAgICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLFxuICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZFxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuXG5cbiAgICAgICAgZnVuY3Rpb24gbG9nb3V0KCkge1xuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3VzZXJfdG9rZW4nKTtcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdsb2dnZWRfdXNlcicpO1xuICAgICAgICAgICAgZGVsZXRlICRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWyd4LWF1dGgnXVxuICAgICAgICAgICAgJHJvb3RTY29wZS5pc0xvZ2dlZCA9IGZhbHNlO1xuICAgICAgICAgICAgJHJvb3RTY29wZS5jdXJyZW50VXNlciA9IG51bGw7XG4gICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9sb2dpblwiKVxuXG5cblxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc3RvcmVUb2tlbihyZXMsIGNiKSB7XG4gICAgICAgICAgICAkd2luZG93LnNlc3Npb25TdG9yYWdlW1widXNlcl90b2tlblwiXSA9IHJlc1xuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3VzZXJfdG9rZW4nLCByZXMpO1xuICAgICAgICAgICAgJGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ3gtYXV0aCddID0gJHdpbmRvdy5zZXNzaW9uU3RvcmFnZS51c2VyX3Rva2VuXG4gICAgICAgICAgICBpZiAoY2IgJiYgKHR5cGVvZiBjYiA9PT0gJ2Z1bmN0aW9uJykpIHtcbiAgICAgICAgICAgICAgICBjYigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gaXNMb2dnZWQoKSB7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHBvc3RMb2dpbk9wcyhyZXMsIGNiKSB7XG5cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgJHJvb3RTY29wZS5jdXJyZW50VXNlciA9IHJlcy5uYW1lXG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnbG9nZ2VkX3VzZXInLCAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyKVxuICAgICAgICAgICAgJHJvb3RTY29wZS5pc0xvZ2dlZCA9IHRydWU7XG4gICAgICAgICAgICBpZiAoY2IgJiYgKHR5cGVvZiBjYiA9PT0gJ2Z1bmN0aW9uJykpIHtcbiAgICAgICAgICAgICAgICBjYigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBwb3N0TG9naW5Sb3V0ZUhhbmRsZXIoKSB7XG4gICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5pbnRlbmRlZFJvdXRlKSB7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJHJvb3RTY29wZS5pbnRlbmRlZFJvdXRlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9ob21lJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG5cbiAgICB9KVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
